// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Curry from "rescript/lib/es6/curry.js";
import * as React from "react";
import * as Belt_Option from "rescript/lib/es6/belt_Option.js";
import * as RescriptReactRouter from "@rescript/react/lib/es6/src/RescriptReactRouter.bs.js";
import * as ReactTransitionGroup from "react-transition-group";
import * as Home$RescriptReactBoilerplate from "./Home.bs.js";
import * as Link$RescriptReactBoilerplate from "./router/Link.bs.js";
import * as Page1$RescriptReactBoilerplate from "./Page1.bs.js";
import * as Page2$RescriptReactBoilerplate from "./Page2.bs.js";
import * as Page3$RescriptReactBoilerplate from "./Page3.bs.js";
import * as Redirect$RescriptReactBoilerplate from "./router/Redirect.bs.js";

require("../../../src/App.scss");

require("../../../src/ReactTransitionGroup.scss");

function App(Props) {
  var url = RescriptReactRouter.useUrl(undefined, undefined);
  var match = url.path;
  var title;
  if (match) {
    switch (match.hd) {
      case "page1" :
          title = match.tl ? "Not Found" : "Page 1";
          break;
      case "page2" :
          title = match.tl ? "Not Found" : "Page 2";
          break;
      case "page3" :
          title = match.tl ? "Not Found" : "Page 3";
          break;
      default:
        title = "Not Found";
    }
  } else {
    title = "Home";
  }
  var navRef = React.useRef(null);
  var nav = navRef.current;
  var width = (nav == null) ? 0.0 : nav.clientWidth;
  var match$1 = React.useReducer((function (state, action) {
          if (typeof action === "number") {
            if (!state.isOpen) {
              return state;
            }
            var match = Belt_Option.getWithDefault(state.touches.first, [
                  0.0,
                  0.0
                ]);
            var match$1 = Belt_Option.getWithDefault(state.touches.last, [
                  0.0,
                  0.0
                ]);
            var x$p = match$1[0];
            var velocity = (x$p - match[0]) / (match$1[1] - match[1]);
            var state_isOpen = state.isOpen;
            var state_touches = {
              first: undefined,
              last: undefined
            };
            var state$1 = {
              isOpen: state_isOpen,
              touches: state_touches
            };
            if (velocity < -0.3 || x$p < width / 2.0) {
              return {
                      isOpen: false,
                      touches: {
                        first: undefined,
                        last: undefined
                      }
                    };
            } else {
              return state$1;
            }
          }
          switch (action.TAG | 0) {
            case /* ToggleMenu */0 :
                return {
                        isOpen: action._0,
                        touches: state.touches
                      };
            case /* TouchStart */1 :
                if (state.isOpen) {
                  return {
                          isOpen: state.isOpen,
                          touches: {
                            first: [
                              action._0,
                              window.performance.now()
                            ],
                            last: undefined
                          }
                        };
                } else {
                  return state;
                }
            case /* TouchMove */2 :
                if (!state.isOpen) {
                  return state;
                }
                var init = state.touches;
                return {
                        isOpen: state.isOpen,
                        touches: {
                          first: init.first,
                          last: [
                            action._0,
                            window.performance.now()
                          ]
                        }
                      };
            
          }
        }), {
        isOpen: false,
        touches: {
          first: undefined,
          last: undefined
        }
      });
  var dispatch = match$1[1];
  var state = match$1[0];
  React.useEffect(function () {
        var handler = function (param) {
          return Curry._1(dispatch, {
                      TAG: /* ToggleMenu */0,
                      _0: false
                    });
        };
        window.addEventListener("popstate", handler);
        return (function (param) {
                  return window.removeEventListener("popstate", handler);
                });
      });
  var match$2 = state.touches;
  var match$3 = match$2.first;
  var tmp;
  var exit = 0;
  if (match$3 !== undefined) {
    var match$4 = match$2.last;
    if (match$4 !== undefined) {
      var x$p = match$4[0];
      var x = match$3[0];
      tmp = {
        transition: "none",
        transform: "translateX(" + ((
              x$p - x > 0.0 ? 0.0 : x$p - x
            ).toString() + "0px)")
      };
    } else {
      exit = 1;
    }
  } else {
    exit = 1;
  }
  if (exit === 1) {
    tmp = {};
  }
  var match$5 = url.path;
  var tmp$1;
  var exit$1 = 0;
  if (match$5) {
    switch (match$5.hd) {
      case "page1" :
          if (match$5.tl) {
            exit$1 = 1;
          } else {
            tmp$1 = React.createElement(Page1$RescriptReactBoilerplate.make, {});
          }
          break;
      case "page2" :
          if (match$5.tl) {
            exit$1 = 1;
          } else {
            tmp$1 = React.createElement(Page2$RescriptReactBoilerplate.make, {});
          }
          break;
      case "page3" :
          if (match$5.tl) {
            exit$1 = 1;
          } else {
            tmp$1 = React.createElement(Page3$RescriptReactBoilerplate.make, {});
          }
          break;
      default:
        exit$1 = 1;
    }
  } else {
    tmp$1 = React.createElement(Home$RescriptReactBoilerplate.make, {});
  }
  if (exit$1 === 1) {
    tmp$1 = React.createElement(Redirect$RescriptReactBoilerplate.make, {
          to_: "/"
        });
  }
  return React.createElement("div", {
              className: "App " + (
                state.isOpen ? "overlay" : ""
              ),
              onClick: (function (_event) {
                  if (state.isOpen) {
                    return Curry._1(dispatch, {
                                TAG: /* ToggleMenu */0,
                                _0: false
                              });
                  }
                  
                }),
              onTouchEnd: (function (_event) {
                  return Curry._1(dispatch, /* TouchEnd */0);
                }),
              onTouchMove: (function ($$event) {
                  return Curry._1(dispatch, {
                              TAG: /* TouchMove */2,
                              _0: $$event.changedTouches.item(0).clientX
                            });
                }),
              onTouchStart: (function ($$event) {
                  return Curry._1(dispatch, {
                              TAG: /* TouchStart */1,
                              _0: $$event.changedTouches.item(0).clientX
                            });
                })
            }, React.createElement("header", undefined, React.createElement("a", {
                      onClick: (function ($$event) {
                          $$event.stopPropagation();
                          return Curry._1(dispatch, {
                                      TAG: /* ToggleMenu */0,
                                      _0: true
                                    });
                        })
                    }, React.createElement("img", {
                          src: require("../../../src/img/icon/hamburger.svg")
                        })), React.createElement("h1", undefined, title)), React.createElement("nav", {
                  ref: navRef,
                  className: state.isOpen ? "active" : "",
                  style: tmp,
                  onClick: (function ($$event) {
                      $$event.stopPropagation();
                      
                    })
                }, React.createElement("header", undefined, React.createElement("a", {
                          onClick: (function (_event) {
                              return Curry._1(dispatch, {
                                          TAG: /* ToggleMenu */0,
                                          _0: false
                                        });
                            })
                        }, React.createElement("img", {
                              src: require("../../../src/img/icon/arrow.svg")
                            }), title)), React.createElement("label", undefined, "home"), React.createElement("ul", undefined, React.createElement("li", undefined, React.createElement(Link$RescriptReactBoilerplate.make, {
                              href: "/",
                              children: "Home",
                              isNavLink: true
                            }))), React.createElement("label", undefined, "pages"), React.createElement("ul", undefined, React.createElement("li", undefined, React.createElement(Link$RescriptReactBoilerplate.make, {
                              href: "/page1",
                              children: "Page1",
                              isNavLink: true
                            })), React.createElement("li", undefined, React.createElement(Link$RescriptReactBoilerplate.make, {
                              href: "/page2",
                              children: "Page2",
                              isNavLink: true
                            })), React.createElement("li", undefined, React.createElement(Link$RescriptReactBoilerplate.make, {
                              href: "/page3",
                              children: "Page3",
                              isNavLink: true
                            })))), React.createElement("main", undefined, React.createElement(ReactTransitionGroup.TransitionGroup, {
                      children: React.createElement(ReactTransitionGroup.CSSTransition, {
                            in: true,
                            timeout: 900,
                            classNames: "routeTransition",
                            children: tmp$1,
                            key: title
                          })
                    })));
}

var make = App;

export {
  make ,
  
}
/*  Not a pure module */
